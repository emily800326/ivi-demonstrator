<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src\routes\carIndicatorService.ts - Intel Tizen IVI Engine</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.7.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.7.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="https:&#x2F;&#x2F;www.tizen.org&#x2F;sites&#x2F;all&#x2F;themes&#x2F;tizen_theme&#x2F;logo.png" title="Intel Tizen IVI Engine"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.2012105.151454</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/AbstractService.AbstractService.html">AbstractService.AbstractService</a></li>
            
                <li><a href="..&#x2F;classes/AbstractService.AbstractServiceOptions.html">AbstractService.AbstractServiceOptions</a></li>
            
                <li><a href="..&#x2F;classes/AbstractService.EndpointAction.html">AbstractService.EndpointAction</a></li>
            
                <li><a href="..&#x2F;classes/AbstractService.EndpointActionParameter.html">AbstractService.EndpointActionParameter</a></li>
            
                <li><a href="..&#x2F;classes/ApiEndpointBase.ApiEndpointBase.html">ApiEndpointBase.ApiEndpointBase</a></li>
            
                <li><a href="..&#x2F;classes/AudioService.AudioService.html">AudioService.AudioService</a></li>
            
                <li><a href="..&#x2F;classes/AudioService.StatusData.html">AudioService.StatusData</a></li>
            
                <li><a href="..&#x2F;classes/CarIndicatorService.CarIndicatorService.html">CarIndicatorService.CarIndicatorService</a></li>
            
                <li><a href="..&#x2F;classes/CarIndicatorService.RandomizerData.html">CarIndicatorService.RandomizerData</a></li>
            
                <li><a href="..&#x2F;classes/CarIndicatorService.StatusData.html">CarIndicatorService.StatusData</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.AlphabetBookmark.html">com.intel.tizen.coulomb.2012.AlphabetBookmark</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.AudioPlayer.html">com.intel.tizen.coulomb.2012.AudioPlayer</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.BottomPanel.html">com.intel.tizen.coulomb.2012.BottomPanel</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.BoxCaption.html">com.intel.tizen.coulomb.2012.BoxCaption</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.ButtonControlsObj.html">com.intel.tizen.coulomb.2012.ButtonControlsObj</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.Carousel.html">com.intel.tizen.coulomb.2012.Carousel</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.Clock.html">com.intel.tizen.coulomb.2012.Clock</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.ClockPlugin.html">com.intel.tizen.coulomb.2012.ClockPlugin</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.global.html">com.intel.tizen.coulomb.2012.global</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.jQuery.html">com.intel.tizen.coulomb.2012.jQuery</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.Library.html">com.intel.tizen.coulomb.2012.Library</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.MusicLibraryFileSystem.html">com.intel.tizen.coulomb.2012.MusicLibraryFileSystem</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.progressBarPlugin.html">com.intel.tizen.coulomb.2012.progressBarPlugin</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.Settings.html">com.intel.tizen.coulomb.2012.Settings</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.Tabs.html">com.intel.tizen.coulomb.2012.Tabs</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.Themes.html">com.intel.tizen.coulomb.2012.Themes</a></li>
            
                <li><a href="..&#x2F;classes/com.intel.tizen.coulomb.2012.TopBarIcons.html">com.intel.tizen.coulomb.2012.TopBarIcons</a></li>
            
                <li><a href="..&#x2F;classes/Engine.Server.html">Engine.Server</a></li>
            
                <li><a href="..&#x2F;classes/EventSourceDispatcher.EventSourceDispatcher.html">EventSourceDispatcher.EventSourceDispatcher</a></li>
            
                <li><a href="..&#x2F;classes/EventSourceDispatcher.EventUpdateData.html">EventSourceDispatcher.EventUpdateData</a></li>
            
                <li><a href="..&#x2F;classes/HomeScreenService.HomeScreenService.html">HomeScreenService.HomeScreenService</a></li>
            
                <li><a href="..&#x2F;classes/PackageRepositoryService.AvailablePackageData.html">PackageRepositoryService.AvailablePackageData</a></li>
            
                <li><a href="..&#x2F;classes/PackageRepositoryService.CategoryData.html">PackageRepositoryService.CategoryData</a></li>
            
                <li><a href="..&#x2F;classes/PackageRepositoryService.InstalledPackageData.html">PackageRepositoryService.InstalledPackageData</a></li>
            
                <li><a href="..&#x2F;classes/PackageRepositoryService.PackageEventData.html">PackageRepositoryService.PackageEventData</a></li>
            
                <li><a href="..&#x2F;classes/PackageRepositoryService.PackageRepositoryOptions.html">PackageRepositoryService.PackageRepositoryOptions</a></li>
            
                <li><a href="..&#x2F;classes/PackageRepositoryService.PackageRepositoryService.html">PackageRepositoryService.PackageRepositoryService</a></li>
            
                <li><a href="..&#x2F;classes/PackageRepositoryService.ThemeData.html">PackageRepositoryService.ThemeData</a></li>
            
                <li><a href="..&#x2F;classes/PersistentConsole.console.html">PersistentConsole.console</a></li>
            
                <li><a href="..&#x2F;classes/ThemeEngineService.ThemeEngineService.html">ThemeEngineService.ThemeEngineService</a></li>
            
                <li><a href="..&#x2F;classes/TizenApplicationStubService.TizenApplicationStubService.html">TizenApplicationStubService.TizenApplicationStubService</a></li>
            
                <li><a href="..&#x2F;classes/UserStatusService.UserDetails.html">UserStatusService.UserDetails</a></li>
            
                <li><a href="..&#x2F;classes/UserStatusService.UserSettings.html">UserStatusService.UserSettings</a></li>
            
                <li><a href="..&#x2F;classes/UserStatusService.UserStatusService.html">UserStatusService.UserStatusService</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src\routes\carIndicatorService.ts</h1>

<div class="file">
    <pre class="code prettyprint linenums">
import abstractService = module(&quot;abstractService&quot;);
import eventSourceDispatcher = module(&quot;..&#x2F;eventSourceDispatcher&quot;);
import express = module(&quot;express&quot;);

&#x2F;**
 * @namespace CarIndicatorService
 *&#x2F;

&#x2F;**
* Wraps status of car indicators
* @class StatusData
*&#x2F;
export interface StatusData {
    &#x2F;** 
    * Front left wheel indicator.
    * @property frontLeftwhell
    * @type {String}
    *&#x2F;
    frontLeftwhell: string;
    &#x2F;** 
    * Front right wheel indicator.
    * @property frontRightwhell
    * @type {String}
    *&#x2F;
    frontRightwhell: string;
    &#x2F;** 
    * Rear left wheel indicator.
    * @property rearLeftwhell
    * @type {String}
    *&#x2F;
    rearLeftwhell: string;
    &#x2F;** 
    * Rear left wheel indicator.
    * @property rearRightwhell
    * @type {String}
    *&#x2F;
    rearRightwhell: string;
    &#x2F;** 
    * Child lock toggle indicator.
    * @property childLock
    * @type {Boolean}
    *&#x2F;
    childLock: bool;
    &#x2F;** 
    * Front lights toggle indicator.
    * @property frontLights
    * @type {Boolean}
    *&#x2F;
    frontLights: bool;
    &#x2F;** 
    * Rear lights toggle indicator.
    * @property rearLights
    * @type {Boolean}
    *&#x2F;
    rearLights: bool;
    &#x2F;** 
    * Air conditioning fan toggle indicator.
    * @property fan
    * @type {Boolean}
    *&#x2F;
    fan: bool;
    &#x2F;** 
    * Battery status (percentage) indicator.
    * @property batteryStatus
    * @type {Float}
    *&#x2F;
    batteryStatus: number;
    &#x2F;** 
    * Full battery capacity indicator.
    * @property fullBatteryRange
    * @type {Float}
    *&#x2F;
    fullBatteryRange: number;
    &#x2F;** 
    * Outside temperature indicator.
    * @property outsideTemp
    * @type {Float}
    *&#x2F;
    outsideTemp: number;
    &#x2F;** 
    * Inside temperature indicator.
    * @property insideTemp
    * @type {Float}
    *&#x2F;
    insideTemp: number;
    &#x2F;** 
    * Front wheel angle indicator.
    * @property wheelAngle
    * @type {Float}
    *&#x2F;
    wheelAngle: number;
    &#x2F;** 
    * Weather type indicator.
    * @property weather
    * @type {Integer}
    *&#x2F;
    weather: number;
    &#x2F;** 
    * Average kW indicator
    * @property avgKW
    * @type {Float}
    *&#x2F;
    avgKW: number;
    &#x2F;** 
    * Speed indicator.
    * @property speed
    * @type {Float}
    *&#x2F;
    speed: number;
    &#x2F;** 
    * Odometer indicator.
    * @property odoMeter
    * @type {Boolean}
    *&#x2F;
    odoMeter: number;
    &#x2F;** 
    * Current gear indicator.
    * @property gear
    * @type {String}
    *&#x2F;
    gear: string;
}

&#x2F;**
* Wraps status of randomizer
* @class RandomizerData
*&#x2F;
interface RandomizerData {
    &#x2F;** 
    * Indicates if randomizer is turned on or off.
    * @property enabled
    * @type {Boolean}
    *&#x2F;
    enabled: bool;
    &#x2F;** 
    * Defines duration between random status changes in milliseconds.
    * @property timeout
    * @type {Number}
    *&#x2F;
    timeout: number;
    &#x2F;** 
    * Interval ID for cancellation
    * @property intervalId
    * @private
    * @type {Number}
    *&#x2F;
    intervalId?: number;
}

&#x2F;** 
* &#x60;&#x2F;carIndicator&#x60;
*
* API provides access to stub indicators for car status. This should be replaced by access to real CAN bus and other sensors in later phases. API also supports option to send randomized data
* to demonstrate real-time updates via &#x60;setRandomizer&#x60; method. Notification are sent to listeners by 
* HTML5 &#x60;EventSourc&#x60;e mechanism available in class &#x60;CarIndicator.addStatusListener&#x60;, e.g.:
*
*     var carIndicator = new CarIndicator ();   
*     carIndicator.addStatusListener(function (data) { 
*         &#x2F;&#x2F; Process status change
*     });
*
* @class CarIndicatorService
* @extends AbstractService.AbstractService
* @constructor
*&#x2F;
&#x2F;** 
* Event fired after one or more car indicators changed.
* @event changed
* @param aData {CarIndicatorService.StatusData} New car indicator status
* @for CarIndicatorService
*&#x2F;
export class CarIndicatorService extends abstractService.AbstractService {
    &#x2F;** 
    * Car indicator status data
    * @property status
    * @type {CarIndicatorService.StatusData}
    *&#x2F;
    public status: StatusData;
    &#x2F;** 
    * Randomizer data
    * @property randomizer
    * @private
    * @type {CarIndicatorService.RandomizerData}
    *&#x2F;
    private randomizer: RandomizerData;

    &#x2F;** 
    * @method constructor
    * @param eventSourceDispatcher {EventSourceDispatcher.EventSourceDispatcher} Instance of &#x60;EventSourceDispatcher&#x60;
    *&#x2F;
    constructor (eventSourceDispatcher: eventSourceDispatcher.EventSourceDispatcher) {
        super({
            name: &quot;CarIndicator&quot;,
            description: &quot;Car indicator&quot;,
            apiClassName: &quot;CarIndicator&quot;,
            indexView: &quot;carindicator&quot;,
            eventSourceDispatcher: eventSourceDispatcher
        });

        this.status = {
            frontLeftwhell: &quot;&quot;,
            frontRightwhell: &quot;&quot;,
            rearLeftwhell: &quot;&quot;,
            rearRightwhell: &quot;&quot;,
            childLock: false,
            frontLights: false,
            rearLights: false,
            fan: false,
            batteryStatus: 58,
            fullBatteryRange: 350,
            outsideTemp: 74.20,
            insideTemp: 68.20,
            wheelAngle: 0,
            weather: 1,
            avgKW: 0.28,
            speed: 65,
            odoMeter: 75126,
            gear: &quot;D&quot;
        };

        this.randomizer = {
            enabled: false,
            timeout: 2000,
            intervalId: undefined
        };
    }

    attachApplication(aApplication: any) {
        var self = this;
        this.actions.splice(this.actions.length, 0, {
            type: &quot;event&quot;,
            title: &quot;Indicator live status&quot;,
            apiMethod: &quot;addStatusListener&quot;,
            message: &quot;status&quot;
        }, {
            type: &quot;get&quot;,
            title: &quot;Get status&quot;,
            apiMethod: &quot;getStatus&quot;,
            endpoint: &quot;&#x2F;status&quot;,
            callback: this.getStatus
        }, {
            type: &quot;post&quot;,
            title: &quot;Set status&quot;,
            apiMethod: &quot;setStatus&quot;,
            endpoint: &quot;&#x2F;status&quot;,
            callback: this.postStatus,
            parameters: [{
                name: &quot;indicator&quot;,
                type: &quot;text&quot;,
                value: &quot;fan&quot;
            }, {
                name: &quot;status&quot;,
                type: &quot;checkbox&quot;,
                value: &quot;true&quot;
            }, {
                name: &quot;text_status&quot;,
                type: &quot;text&quot;,
                value: &quot;&quot;
            }]
        }, {
            type: &quot;post&quot;,
            title: &quot;Set randomizer&quot;,
            apiMethod: &quot;setRandomizeStatus&quot;,
            endpoint: &quot;&#x2F;randomizeStatus&quot;,
            callback: this.setRandomizeStatus,
            parameters: [
                {
                    name: &quot;enabled&quot;,
                    type: &quot;text&quot;,
                    value: &quot;true&quot;
                },
                {
                    name: &quot;timeout&quot;,
                    type: &quot;text&quot;,
                    value: &quot;10000&quot;
                }
            ]
        });

        super.attachApplication(aApplication);
        this.on(&quot;changed&quot;, function (aStatus) {
            self.sendStatus(&quot;status&quot;, aStatus);
        });
    }

    &#x2F;**
    * &#x60;[GET] &#x2F;status&#x60; Returns current indicator status
    * @method getStatus
    * @return {CarIndicatorService.StatusData}
    *&#x2F;
    getStatus(aRequest: express.ExpressServerRequest, aResponse: express.ExpressServerResponse) {
        aResponse.json(this.status);
    }

    &#x2F;**
    * Set single indicator status
    * @method _setStatus
    * @param aStatusData {CarIndicatorService.StatusData} New status data object
    *&#x2F;
    _setStatus(aStatusData: StatusData) {
        this.status = aStatusData;
        this.emit(&#x27;changed&#x27;, this.status);
    }

    &#x2F;**
    * &#x60;[POST] &#x2F;status&#x60; Set single car indicator status
    * @method postStatus
    * @param indicator {String} Indicator name
    * @param status {String} Indicator value
    *&#x2F;
    postStatus(aRequest: express.ExpressServerRequest, aResponse: express.ExpressServerResponse) {
        var self = this;
        this.status[aRequest.body.indicator] = aRequest.body.status == &quot;true&quot;;
        if (this.status[aRequest.body.text_status] !== &quot;&quot;) {
            this.status[aRequest.body.indicator] = aRequest.body.text_status;
        } else {
            this.status[aRequest.body.indicator] = aRequest.body.status == &quot;true&quot;;
        }
        this._setStatus(this.status);
        this.getStatus(aRequest, aResponse);
    }

    &#x2F;**
    * &#x60;[POST] &#x2F;randomizeStatus&#x60; Set randomizer status
    * @method setRandomizeStatus
    * @param enabled {String} [&#x60;true&#x60;|&#x60;false&#x60;] Toggles randomizer on or off
    * @param timeout {Integer} Interval between randomized value in milliseconds
    *&#x2F;
    setRandomizeStatus(aRequest: express.ExpressServerRequest, aResponse: express.ExpressServerResponse) {
        var self = this;
        this.randomizer.enabled = aRequest.body.enabled.toString() == &quot;true&quot;;
        this.randomizer.timeout = aRequest.body.timeout;
        this.logger.info(&quot;this.randomizer.enabled: %s&quot;, this.randomizer.enabled);
        if (this.randomizer.intervalId) {
            clearInterval(this.randomizer.intervalId);
            this.randomizer.intervalId = undefined;
        }

        if (this.randomizer.enabled) {
            this.randomizer.intervalId = setInterval(function () {
                for (var attr in self.status) {
                    if (attr != &quot;fullBatteryRange&quot; &amp;&amp; attr != &quot;batteryStatus&quot; &amp;&amp; attr != &quot;frontLeftwhell&quot; &amp;&amp; attr != &quot;frontRightwhell&quot; &amp;&amp; attr != &quot;rearLeftwhell&quot; &amp;&amp; attr != &quot;rearRightwhell&quot; &amp;&amp; attr != &quot;outsideTemp&quot; &amp;&amp; attr != &quot;insideTemp&quot; &amp;&amp; attr != &quot;weather&quot; &amp;&amp; attr != &quot;avgKW&quot; &amp;&amp; attr != &quot;speed&quot; &amp;&amp; attr != &quot;wheelAngle&quot; &amp;&amp; attr != &quot;randomizer&quot;) {
                        self.status[attr] = Math.random() &gt; 0.5;
                    }
                    if (attr == &quot;batteryStatus&quot;) {
                        if (self.status[attr] &gt; 10) {

                            self.status[attr] = Math.round(self.status[attr] - (Math.random() * 10));
                        } else {
                            self.status[attr] = 100;
                        }

                    }
                    if (attr == &quot;outsideTemp&quot;) {
                        self.status[attr] += 3 - Math.round(Math.random() * 5);
                        if (self.status[attr] &gt; 130) {
                            self.status[attr] = 77
                        } else if (self.status[attr] &gt; 130) {
                            self.status[attr] = -58
                        }
                    }
                    if (attr == &quot;insideTemp&quot;) {
                        self.status[attr] += 3 - Math.round(Math.random() * 5);
                        if (self.status[attr] &gt; 130) {
                            self.status[attr] = 77
                        } else if (self.status[attr] &gt; 130) {
                            self.status[attr] = -58
                        }
                    }
                    if (attr == &quot;weather&quot;) {
                        self.status[attr] = 1 + Math.round(2 * Math.random());
                        var randomNumber: number = Math.random();
                    }
                    if (attr == &quot;wheelAngle&quot;) {
                        var randomNumber: number = Math.random() * 30;
                        var direction: number;
                        if (Math.random() &gt; 0.5) {
                            direction = 1;

                        } else {
                            direction = -1;
                        }
                        self.status[attr] = (randomNumber * direction);
                        if (self.status[attr] &gt; 30) {
                            self.status[attr] = 30;
                        } else if (self.status[attr] &lt; (-30)) {
                            self.status[attr] = -30;
                        }
                    }
                    if (attr == &quot;gear&quot;) {
                        var randomNumber: number = 1 + Math.floor(6 * Math.random());
                        self.status[attr] = randomNumber;
                        self.status[attr] = randomNumber == 4 ? &quot;D&quot; : self.status[attr];
                        self.status[attr] = randomNumber == 5 ? &quot;R&quot; : self.status[attr];
                        self.status[attr] = randomNumber == 6 ? &quot;N&quot; : self.status[attr];
                    }
                    if (attr == &quot;speed&quot;) {
                        self.status[attr] = Math.floor(85 * Math.random());
                    }
                    if (attr == &quot;odoMeter&quot;) {
                        self.status[attr] = 50000 + Math.floor(10000 * Math.random());
                    }


                }

                self.status[&quot;randomizer&quot;] = true;
                self.emit(&#x27;changed&#x27;, self.status);

            }, this.randomizer.timeout);
        } else {
            self.status[&quot;randomizer&quot;] = false;
            this.logger.info(&quot;this.randomizer.enabled: stop interval&quot;);
            clearInterval(this.randomizer.intervalId);
            self.emit(&#x27;changed&#x27;, self.status);
        }

        aResponse.json(this.randomizer);
    }
}
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
